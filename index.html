<!DOCTYPE html>
<html lang="hr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Zmija - Moderno</title>
    <style>
        /* Allgemeines Styling */
        body {
            margin: 0;
            font-family: 'Arial', sans-serif;
            background: linear-gradient(45deg, #3a1c71, #d76d77, #ffaf7b);
            animation: bgAnimation 10s infinite alternate;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            overflow: hidden;
        }

        @keyframes bgAnimation {
            0% { background-position: 0% 50%; }
            50% { background-position: 50% 100%; }
            100% { background-position: 100% 50%; }
        }

        h1 {
            color: #fff;
            font-size: 3em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 8px rgba(0, 0, 0, 0.5);
        }

        .menu-container {
            background: rgba(255, 255, 255, 0.8);
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
            text-align: center;
            width: 300px;
        }

        .highscores {
            margin: 15px 0;
            color: #333;
            font-size: 1.2em;
        }

        .name-input {
            margin-top: 10px;
            margin-bottom: 15px;
        }

        .name-input input {
            padding: 10px;
            font-size: 1em;
            border: 2px solid #ccc;
            border-radius: 5px;
            width: 80%;
        }

        button {
            padding: 10px 20px;
            font-size: 1.2em;
            background: #00b09b;
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: transform 0.2s, background 0.2s;
        }

        button:hover {
            transform: scale(1.1);
            background: #005f73;
        }

        canvas {
            display: none;
            background: #f4f9f4;
            border: 3px solid white;
            box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.5);
        }
    </style>
</head>
<body>
    <div class="menu-container" id="menu">
        <h1>Zmija</h1>
        <div class="highscores" id="highscores">
            <strong>Najbolji igrači:</strong>
            <ol id="highscoreList"></ol>
        </div>
        <div class="name-input">
            <input type="text" id="playerName" placeholder="Unesite ime">
        </div>
        <button onclick="startGame()">Započni igru</button>
    </div>
    <canvas id="gameCanvas" width="400" height="400"></canvas>

    <script>
        const menu = document.getElementById('menu');
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const playerNameInput = document.getElementById('playerName');
        const highscoreList = document.getElementById('highscoreList');
        let highscores = [];
        let playerName = '';
        let invalidNameAttempts = 0;

        function startGame() {
            playerName = playerNameInput.value.trim();
            if (!playerName) {
                if (invalidNameAttempts === 0) {
                    alert('A ime dodati?');
                } else if (invalidNameAttempts === 1) {
                    alert('Jesi smotan de dodaj ime');
                } else {
                    alert('Mama, to si sigurno ti, de uzmi naočale!');
                }
                invalidNameAttempts++;
                return;
            }
            invalidNameAttempts = 0; // Reset attempts
            menu.style.display = 'none';
            canvas.style.display = 'block';
            startSnakeGame();
        }

        function updateHighscores(newScore) {
            highscores.push({ name: playerName, score: newScore });
            highscores.sort((a, b) => b.score - a.score);
            highscores = highscores.slice(0, 10); // Keep only top 10
            renderHighscores();
        }

        function renderHighscores() {
            highscoreList.innerHTML = highscores.map(h => `<li>${h.name}: ${h.score}</li>`).join('');
        }

        function startSnakeGame() {
            let snake = [{ x: 200, y: 200 }];
            let direction = { x: 0, y: 0 };
            let food = { x: 0, y: 0, color: 'red' };
            let score = 0;

            function spawnFood() {
                food.x = Math.floor(Math.random() * (canvas.width / 20)) * 20;
                food.y = Math.floor(Math.random() * (canvas.height / 20)) * 20;
                food.color = `hsl(${Math.random() * 360}, 70%, 50%)`;
            }

            function drawSnake() {
                ctx.fillStyle = 'green';
                snake.forEach(segment => ctx.fillRect(segment.x, segment.y, 20, 20));
            }

            function drawFood() {
                ctx.fillStyle = food.color;
                ctx.beginPath();
                ctx.arc(food.x + 10, food.y + 10, 10, 0, Math.PI * 2);
                ctx.fill();
            }

            function updateGame() {
                const head = { x: snake[0].x + direction.x, y: snake[0].y + direction.y };

                if (
                    head.x < 0 || head.x >= canvas.width || head.y < 0 || head.y >= canvas.height ||
                    snake.some(segment => segment.x === head.x && segment.y === head.y)
                ) {
                    alert(`Igra je završena! Bodovi: ${score}`);
                    updateHighscores(score);
                    menu.style.display = 'block';
                    canvas.style.display = 'none';
                    return;
                }

                snake.unshift(head);

                if (head.x === food.x && head.y === food.y) {
                    score++;
                    spawnFood();
                } else {
                    snake.pop();
                }

                ctx.clearRect(0, 0, canvas.width, canvas.height);
                drawSnake();
                drawFood();
                setTimeout(updateGame, 200);
            }

            spawnFood();
            updateGame();

            document.addEventListener('keydown', (e) => {
                if (e.key === 'ArrowUp' && direction.y === 0) direction = { x: 0, y: -20 };
                if (e.key === 'ArrowDown' && direction.y === 0) direction = { x: 0, y: 20 };
                if (e.key === 'ArrowLeft' && direction.x === 0) direction = { x: -20, y: 0 };
                if (e.key === 'ArrowRight' && direction.x === 0) direction = { x: 20, y: 0 };
            });
        }
    </script>
</body>
</html>
